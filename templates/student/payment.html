{% extends 'base.html' %}

{% block title %}–ë–∞–ª–∞–Ω—Å | –£–º–Ω–∞—è —Å—Ç–æ–ª–æ–≤–∞—è{% endblock %}

{% block content %}
<div class="page-header">
    <div class="flex flex-between flex-center">
        <div>
            <h1 class="page-title">–í–∞—à —Å—á–µ—Ç</h1>
            <p class="page-subtitle">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏</p>
        </div>
        <div class="text-right">
            <div class="text-muted" style="margin-bottom: 0.25rem;">–î–æ—Å—Ç—É–ø–Ω–æ</div>
            <div class="text-primary" style="font-size: 2rem; font-weight: 700;">{{ user.balance }} ‚ÇΩ</div>
        </div>
    </div>
</div>

<div class="card mb-3">
    <div class="card-header">
        <h2 class="card-title">–ë—ã—Å—Ç—Ä—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è</h2>
        <p class="text-muted" style="margin: 0;">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é —Å—É–º–º—É</p>
    </div>

    <div class="grid grid-4 mb-3">
        <button type="button" class="btn btn-outline" onclick="setAmount(100)">
            <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">100 ‚ÇΩ</div>
        </button>
        <button type="button" class="btn btn-outline" onclick="setAmount(300)">
            <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">300 ‚ÇΩ</div>
        </button>
        <button type="button" class="btn btn-outline" onclick="setAmount(500)">
            <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">500 ‚ÇΩ</div>
        </button>
        <button type="button" class="btn btn-outline" onclick="setAmount(1000)">
            <div style="font-size: 1.5rem; margin-bottom: 0.25rem;">1000 ‚ÇΩ</div>
        </button>
    </div>

    <form method="post">
        {% csrf_token %}

        <div class="form-group">
            <label class="form-label">–ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ—é —Å—É–º–º—É</label>
            <div class="flex" style="gap: 0.5rem; align-items: center;">
                <input type="number" name="amount" id="amountInput" min="1"
                       class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –≤ —Ä—É–±–ª—è—Ö" required
                       style="flex: 1;">
                <span style="font-weight: 600; color: var(--text-muted);">‚ÇΩ</span>
            </div>
            <small class="text-muted" style="display: block; margin-top: 0.25rem;">
                –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è: 1 ‚ÇΩ
            </small>
        </div>

        <div class="flex" style="gap: 1rem; margin-top: 1.5rem;">
            <button type="submit" class="btn btn-primary" style="flex: 1;">
                <span style="margin-right: 0.5rem;">‚Üí</span>
                –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
            </button>
        </div>
    </form>
</div>

<div class="grid grid-2">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–ª–∞—Ç–µ–∂–∞—Ö</h2>
        </div>

        <div style="padding: 0.5rem 0;">
            <div class="flex flex-between flex-center" style="padding: 0.75rem; border-bottom: 1px solid var(--gray-border);">
                <span class="text-muted">–°—Ç–∞—Ç—É—Å —Å—á–µ—Ç–∞</span>
                <span class="badge badge-success">–ê–∫—Ç–∏–≤–µ–Ω</span>
            </div>
            <div class="flex flex-between flex-center" style="padding: 0.75rem; border-bottom: 1px solid var(--gray-border);">
                <span class="text-muted">–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ</span>
                <span>
                    {% if payments.0 %}
                        {{ payments.0.date|date:"d.m.Y" }}
                    {% else %}
                        ‚Äî
                    {% endif %}
                </span>
            </div>
            <div class="flex flex-between flex-center" style="padding: 0.75rem;">
                <span class="text-muted">–í—Å–µ–≥–æ –æ–ø–µ—Ä–∞—Ü–∏–π</span>
                <span>{{ payments|length }}</span>
            </div>
        </div>
    </div>
<div class="card">
        <div class="card-header">
            <h2 class="card-title">–ó–∞–ø–∏—Å–∏ –æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö</h2>
        </div>

        {% if payments %}
        <div style="max-height: 250px; overflow-y: auto;">
            {% for payment in payments|slice:":5" %}
            <div class="flex flex-between flex-center"
                 style="padding: 0.75rem; {% if not forloop.last %}border-bottom: 1px solid var(--gray-border);{% endif %}">
                <div>
                    <div style="font-weight: 600;">{{ payment.date|date:"d.m.Y" }}</div>
                    <div class="text-muted" style="font-size: 0.85rem;">–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å—á–µ—Ç–∞</div>
                </div>
                <div class="text-right">
                    <div style="font-weight: 700; color: #10b981;">+{{ payment.amount }} ‚ÇΩ</div>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state" style="padding: 2rem 1rem;">
            <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.5;">üí≥</div>
            <p style="margin: 0;">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –æ –ø–ª–∞—Ç–µ–∂–∞—Ö</p>
        </div>
        {% endif %}
    </div>
</div>


</div>

<script>
    function setAmount(amount) {
        const input = document.getElementById('amountInput');
        input.value = amount;
        input.focus();
    }

    // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', function() {
        const amountInput = document.getElementById('amountInput');
        if (amountInput) {
            amountInput.focus();
        }
    });
</script>

<style>
    .btn-outline {
        padding: 1rem 0.5rem;
        text-align: center;
        transition: all 0.2s;
    }

    .btn-outline:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 215, 0, 0.15);
    }

    .grid-4 {
        grid-template-columns: repeat(4, 1fr);
    }

    @media (max-width: 768px) {
        .grid-4 {
            grid-template-columns: repeat(2, 1fr);
        }
    }
</style>
{% endblock %}