{% extends 'base.html' %}

{% block title %}–ü–∞–Ω–µ–ª—å –ø–æ–≤–∞—Ä–∞ | –£–º–Ω–∞—è —Å—Ç–æ–ª–æ–≤–∞—è{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">–ü–∞–Ω–µ–ª—å –ø–æ–≤–∞—Ä–∞</h1>
    <p class="page-subtitle">{{ today|date:"d.m.Y" }}</p>
</div>

<div class="grid grid-3">
    <div class="stat-card">
        <div class="stat-icon">üç≥</div>
        <div class="stat-info">
            <h3>{{ menu.given_breakfasts_amount|default:0 }}</h3>
            <p>–í—ã–¥–∞–Ω–æ –∑–∞–≤—Ç—Ä–∞–∫–æ–≤</p>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">üç≤</div>
        <div class="stat-info">
            <h3>{{ menu.given_lunches_amount|default:0 }}</h3>
            <p>–í—ã–¥–∞–Ω–æ –æ–±–µ–¥–æ–≤</p>
        </div>
    </div>
    
    <div class="stat-card">
        <div class="stat-icon">‚ö†Ô∏è</div>
        <div class="stat-info">
            <h3>{{ low_stock.count }}</h3>
            <p>–ü—Ä–æ–¥—É–∫—Ç–æ–≤ –Ω–∞ –∏—Å—Ö–æ–¥–µ</p>
        </div>
    </div>
</div>

<div class="grid grid-2 mt-3">
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">üìã –ú–µ–Ω—é –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h2>
            <a href="{% url 'cook_menu' %}" class="btn btn-secondary btn-sm">–í—Å–µ –º–µ–Ω—é</a>
        </div>
        
        {% if menu %}
            <div class="section">
                <h4 class="mb-1">üåÖ –ó–∞–≤—Ç—Ä–∞–∫:</h4>
                {% for dish in menu.get_breakfast_dishes %}
                    <span class="badge badge-primary">{{ dish.name }}</span>
                {% empty %}
                    <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
                {% endfor %}
            </div>
            
            <div class="section">
                <h4 class="mb-1">‚òÄÔ∏è –û–±–µ–¥:</h4>
                {% for dish in menu.get_lunch_dishes %}
                    <span class="badge badge-primary">{{ dish.name }}</span>
                {% empty %}
                    <span class="text-muted">–ù–µ —É–∫–∞–∑–∞–Ω–æ</span>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <p>–ú–µ–Ω—é –Ω–∞ —Å–µ–≥–æ–¥–Ω—è –Ω–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–æ</p>
                <a href="{% url 'cook_menu_create' %}" class="btn btn-primary mt-2">–°–æ–∑–¥–∞—Ç—å –º–µ–Ω—é</a>
            </div>
        {% endif %}
    </div>
    
    <div class="card">
        <div class="card-header">
            <h2 class="card-title">‚ö†Ô∏è –ü—Ä–æ–¥—É–∫—Ç—ã –Ω–∞ –∏—Å—Ö–æ–¥–µ</h2>
            <a href="{% url 'cook_products' %}" class="btn btn-secondary btn-sm">–í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã</a>
        </div>
        
        {% if low_stock %}
        <table class="table">
            <thead>
                <tr>
                    <th>–ü—Ä–æ–¥—É–∫—Ç</th>
                    <th>–û—Å—Ç–∞—Ç–æ–∫</th>
                </tr>
            </thead>
            <tbody>
                {% for product in low_stock %}
                <tr>
                    <td>{{ product.name }}</td>
                    <td>
                        <span class="badge {% if product.amount < 5 %}badge-danger{% else %}badge-warning{% endif %}">
                            {{ product.amount }} —à—Ç.
                        </span>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <a href="{% url 'cook_application_create' %}" class="btn btn-primary btn-block mt-2">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –∑–∞–∫—É–ø–∫—É</a>
        {% else %}
        <div class="empty-state">
            <p>–í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –≤ –Ω–∞–ª–∏—á–∏–∏ ‚úì</p>
        </div>
        {% endif %}
    </div>
</div>

<div class="card mt-3">
    <div class="card-header">
        <h2 class="card-title">üìù –ú–æ–∏ –∑–∞—è–≤–∫–∏ –Ω–∞ –∑–∞–∫—É–ø–∫—É</h2>
        <a href="{% url 'cook_applications' %}" class="btn btn-secondary btn-sm">–í—Å–µ –∑–∞—è–≤–∫–∏</a>
    </div>
    
    {% if my_applications %}
    <table class="table">
        <thead>
            <tr>
                <th>‚Ññ</th>
                <th>–î–∞—Ç–∞</th>
                <th>–°—É–º–º–∞</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
            </tr>
        </thead>
        <tbody>
            {% for app in my_applications %}
            <tr>
                <td>#{{ app.id }}</td>
                <td>{{ app.date|date:"d.m.Y" }}</td>
                <td>{{ app.price }} ‚ÇΩ</td>
                <td>
                    {% if app.status == 'pending' %}
                        <span class="badge badge-warning">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
                    {% elif app.status == 'approved' %}
                        <span class="badge badge-success">–û–¥–æ–±—Ä–µ–Ω–∞</span>
                    {% else %}
                        <span class="badge badge-danger">–û—Ç–∫–ª–æ–Ω–µ–Ω–∞</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>–ó–∞—è–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç</p>
    </div>
    {% endif %}
</div>
{% endblock %}
