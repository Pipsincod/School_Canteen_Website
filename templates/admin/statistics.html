{% extends 'base.html' %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | –£–º–Ω–∞—è —Å—Ç–æ–ª–æ–≤–∞—è{% endblock %}

{% block content %}
<div class="page-header">
    <h1 class="page-title">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h1>
    <p class="page-subtitle">–ó–∞ –ø–µ—Ä–∏–æ–¥ {{ month_ago|date:"d.m.Y" }} ‚Äî {{ today|date:"d.m.Y" }}</p>
</div>

<div class="grid grid-3">
    <div class="stat-card">
        <div class="stat-icon">üí∞</div>
        <div class="stat-info">
            <h3>{{ payments_total }} ‚ÇΩ</h3>
            <p>–û–ø–ª–∞—Ç –∑–∞ –º–µ—Å—è—Ü ({{ payments_count }} –ø–ª–∞—Ç–µ–∂–µ–π)</p>
        </div>
    </div>
    
    {% for item in attendance_by_type %}
    <div class="stat-card">
        <div class="stat-icon">
            {% if item.meal_type == 'breakfast' %}üåÖ{% else %}‚òÄÔ∏è{% endif %}
        </div>
        <div class="stat-info">
            <h3>{{ item.count }}</h3>
            <p>{% if item.meal_type == 'breakfast' %}–ó–∞–≤—Ç—Ä–∞–∫–æ–≤{% else %}–û–±–µ–¥–æ–≤{% endif %} –≤—ã–¥–∞–Ω–æ</p>
        </div>
    </div>
    {% endfor %}
</div>

<div class="card mt-3">
    <div class="card-header">
        <h2 class="card-title">‚≠ê –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –±–ª—é–¥–∞ (–ø–æ –æ—Ü–µ–Ω–∫–∞–º)</h2>
    </div>
    
    {% if popular_dishes %}
    <table class="table">
        <thead>
            <tr>
                <th>–ë–ª—é–¥–æ</th>
                <th>–°—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</th>
            </tr>
        </thead>
        <tbody>
            {% for dish in popular_dishes %}
            <tr>
                <td><strong>{{ dish.name }}</strong></td>
                <td>
                    <div class="rating">
                        {% for i in "12345" %}
                            <span class="rating-star {% if forloop.counter <= dish.avg_rating %}filled{% endif %}">‚òÖ</span>
                        {% endfor %}
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <div class="empty-state">
        <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Ü–µ–Ω–∫–∞—Ö</p>
    </div>
    {% endif %}
</div>
{% endblock %}
